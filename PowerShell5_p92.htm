<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>1.7.1 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><span style='mso-bookmark:_Toc189542093'><a
name="_Toc179036966"></a><a name="_Toc197149204"></a><a name="_Ref220466958"></a><a
name="_Ref220466968"></a><a name="_Toc204716215"></a><a name="_Toc209115758"><span
style='mso-bookmark:_Toc204716215'><span style='mso-bookmark:_Ref220466968'><span
style='mso-bookmark:_Ref220466958'><span style='mso-bookmark:_Toc197149204'><span
style='mso-bookmark:_Toc179036966'>
<span lang=HU>Szkriptek
engedélyezése és indítása</span></span></span></span></span></span></a></span></h3>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Készítsük
is el mindjárt első szkriptünket! Olyan fájlt kell készítenünk, amelynek
kiterjesztése </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>ps1</span></span><span
lang=HU>, ez a PowerShell szkriptek alapértelmezett kiterjesztése, még a 2.0-ás
verziónál is. Egyszerűbb esetben még a Notepadre sincs szükség, létrehozhatjuk
a fájl közvetlenül a PowerShellből is:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=Kd style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[1] PS C:\&gt; &quot;'Hurrá! Fut az első szkriptünk.'&quot; |
Out-File elso.ps1</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Hát
ennyi. Látható, hogy nincs szükség túl sok cicomára, amit a parancssorba
beírhatnánk, az minden további nélkül jó szkriptnek is. Indítsuk is el gyorsan
a szkriptet:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[4] PS C:\&gt; C:\elso.ps1</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>File
C:\elso.ps1 cannot be loaded because the execution of scripts is disabled<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'> </span>on this system. Please see &quot;get-help
about_signing&quot; for more details.<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>At line:1
char:12<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>+
C:\elso.ps1 &lt;&lt;&lt;&lt;<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ CategoryInfo<span
style='mso-spacerun:yes'>          </span>: NotSpecified: (:) [],
PSSecurityException<o:p></o:p></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ FullyQualifiedErrorId : RuntimeException<o:p></o:p></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Hoppá! A
PowerShell olyan szkriptkörnyezet, amelyben nem engedélyezett a szkriptek
futtatása?! Természetesen ez csak a „</span></span><span style='mso-bookmark:
_Toc189542093'><span class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>secure-by-default</span></span><span
lang=HU>” jegyében beállított alapértelmezés, a szkriptekkel szemben tanúsított
viselkedést a </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Set-ExecutionPolicy</span></span></span>
<span
style='mso-bookmark:_Toc189542093'></span>
<span
style='mso-bookmark:_Toc189542093'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlet segítségével szabályozhatjuk az alábbi
állapotok közül a megfelelő kiválasztásával:</span></span></p>

<table class=LightList-Accent11 border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid #4F81BD 1.0pt;
 mso-border-themecolor:accent1;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:-1;mso-yfti-firstrow:yes;mso-yfti-lastfirstrow:yes'>
  <td width=149 valign=top style='width:111.75pt;border-top:solid #4F81BD 1.0pt;
  mso-border-top-themecolor:accent1;border-left:solid #4F81BD 1.0pt;mso-border-left-themecolor:
  accent1;border-bottom:none;border-right:none;background:#4F81BD;mso-background-themecolor:
  accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:5'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU style='color:white;mso-themecolor:background1'>Paraméter<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border-top:solid #4F81BD 1.0pt;
  mso-border-top-themecolor:accent1;border-left:none;border-bottom:none;
  border-right:solid #4F81BD 1.0pt;mso-border-right-themecolor:accent1;
  background:#4F81BD;mso-background-themecolor:accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast style='mso-yfti-cnfc:1'><span style='mso-bookmark:_Toc189542093'><b><span
  lang=HU style='color:white;mso-themecolor:background1'>Hatása<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:0'>
  <td width=149 valign=top style='width:111.75pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-right:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:68'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>Restricted<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast style='mso-yfti-cnfc:64'><span style='mso-bookmark:
  _Toc189542093'><span lang=HU>Nem engedélyezett semmilyen szkript futtatása
  (alaphelyzet)</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=149 valign=top style='width:111.75pt;border:none;border-left:solid #4F81BD 1.0pt;
  mso-border-left-themecolor:accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:4'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>AllSigned<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border:none;border-right:solid #4F81BD 1.0pt;
  mso-border-right-themecolor:accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast><span style='mso-bookmark:_Toc189542093'><span lang=HU>Csak
  elektronikusan aláírt szkriptek futtathatók</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=149 valign=top style='width:111.75pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-right:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:68'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>RemoteSigned<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast style='mso-yfti-cnfc:64'><span style='mso-bookmark:
  _Toc189542093'><span lang=HU>Külső forrásból letöltött szkripteknek kell
  aláírtaknak lenniük (hálózat, internet), helyi szkriptek aláírás nélkül is
  futtathatók</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=149 valign=top style='width:111.75pt;border:none;border-left:solid #4F81BD 1.0pt;
  mso-border-left-themecolor:accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:4'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>Unrestricted<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border:none;border-right:solid #4F81BD 1.0pt;
  mso-border-right-themecolor:accent1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast><span style='mso-bookmark:_Toc189542093'><span lang=HU>Korlátozás
  nélkül futtathatók a szkriptek, az internetről letöltött szkriptek esetén
  megerősítést kér</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=149 valign=top style='width:111.75pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-right:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:68'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>Bypass<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border:solid #4F81BD 1.0pt;
  mso-border-themecolor:accent1;border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast style='mso-yfti-cnfc:64'><span style='mso-bookmark:
  _Toc189542093'><span lang=HU>Korlátozás nélkül futtathatók a szkriptek,
  megerősítést sem kér</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=149 valign=top style='width:111.75pt;border-top:none;border-left:
  solid #4F81BD 1.0pt;mso-border-left-themecolor:accent1;border-bottom:solid #4F81BD 1.0pt;
  mso-border-bottom-themecolor:accent1;border-right:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpFirst style='mso-yfti-cnfc:4'><span style='mso-bookmark:
  _Toc189542093'><b><span lang=HU>Undefined<o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
  <td width=518 valign=top style='width:388.5pt;border-top:none;border-left:
  none;border-bottom:solid #4F81BD 1.0pt;mso-border-bottom-themecolor:accent1;
  border-right:solid #4F81BD 1.0pt;mso-border-right-themecolor:accent1;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=TblaCxSpLast><span style='mso-bookmark:_Toc189542093'><span lang=HU>Az
  adott futtatási környezetben beállított végrehajtási házirendet figyelmen
  kívül hagyja, így a magasabb szinten beállított házirend, vagy (ha ilyen
  nincs) a Group Policy segítségével beállított házirend jut érvényre</span></span></p>
  </td>
  <span style='mso-bookmark:_Toc189542093'></span>
 </tr>
</table>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Ahhoz,
hogy mi a saját aláírás nélküli szkriptjeinket futtatni tudjuk, a </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>RemoteSigned</span></span><span
lang=HU> szintet javaslom beállítani:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=Kd style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>PS C:\&gt; Set-ExecutionPolicy -ExecutionPolicy RemoteSigned</span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-bottom:none;mso-border-top-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:1.0pt 4.0pt 0cm 4.0pt;
background:#C6D9F1;mso-background-themecolor:text2;mso-background-themetint:
51;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyzs style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto;background:#C6D9F1;
mso-background-themecolor:text2;mso-background-themetint:51'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Megjegyzés</span></span></p>

</div>

<div style='mso-element:para-border-div;border-top:none;border-left:double windowtext 5.25pt;
border-bottom:none;border-right:double windowtext 5.25pt;mso-border-left-alt:
thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:thin-thick-large-gap windowtext 5.25pt;
padding:0cm 4.0pt 0cm 4.0pt;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megj-nyitottCxSpFirst style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>A végrehajtási házirend
beállításához helyi rendszergazda jogosultság szükséges, illetve Windows Vista,
vagy annál újabb operációs rendszerek esetében ezen kívül a PowerShell
alkalmazást is rendszergazda jogkörrel kell futtatni, hogy ez a parancs lefusson.
Ha nincs valakinek ilyen jogköre, akkor ennek a házirendnek is beállíthatunk a </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>–Scope</span></span><span
lang=HU> paraméterhez egy hatósugarat:</span></span></p>

<p class=Megj-nyitottCxSpMiddle style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Process</span></span><span
lang=HU>: csak az adott PowerShell ablakban állítja be a végrehajtási
házirendet, nem igényel rendszergazda jogosultságot</span></span></p>

<p class=Megj-nyitottCxSpMiddle style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>CurrentUser</span></span><span
lang=HU>: csak az adott felhasználóra állítja be a végrehajtási házirendet, nem
igényel rendszergazda jogosultságot</span></span></p>

<p class=Megj-nyitottCxSpMiddle style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>LocalMachine</span></span><span
lang=HU>: alaphelyzet szerinti beállítás, az adott gép minden felhasználójára
állítja be a végrehajtási házirendet</span></span></p>

<p class=Megj-nyitottCxSpLast style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>Nézzünk erre egy példát:</span></span></p>

</div>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[65] PS C:\&gt; Set-ExecutionPolicy -ExecutionPolicy restricted
-Scope process</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU><o:p>&nbsp;</o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Execution Policy Change</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>The execution policy helps protect you from scripts that you do not
trust.</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Changing the execution policy might expose you to the security
risks described</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'> </span>in the
about_Execution_Policies help topic. Do you want to change the</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>execution policy?</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[Y] Yes<span style='mso-spacerun:yes'>  </span>[N] No<span
style='mso-spacerun:yes'>  </span>[S] Suspend<span style='mso-spacerun:yes'> 
</span>[?] Help (default is &quot;Y&quot;): y</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[66] PS C:\&gt; . .\munka\converthashtocollection.ps1</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>File
C:\munka\converthashtocollection.ps1 cannot be loaded because the executi<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>on of
scripts is disabled on this system. Please see &quot;get-help
about_signing&quot;<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>for more
details.<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>At line:1
char:2<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>+ .
&lt;&lt;&lt;&lt;<span style='mso-spacerun:yes'> 
</span>.\munka\converthashtocollection.ps1<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ CategoryInfo<span
style='mso-spacerun:yes'>          </span>: NotSpecified: (:) [],
PSSecurityException<o:p></o:p></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ FullyQualifiedErrorId : RuntimeException<o:p></o:p></span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-top:none;mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-bottom-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:0cm 4.0pt 1.0pt 4.0pt;
margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyezs2 style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>A fenti példában pont
szigorítottam az adott PowerShell ablak futtatási házirendjét, minek hatására
egy szkript futtatása hibára futott.</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>A globális
biztonsági beállítást a registry-n keresztül is beállíthatjuk, például a
számítógépre:</span></span></p>

<p class=Kp>
 <img src="PowerShell5_files/image065.png">
</p>

<p class=MsoCaption><span style='mso-bookmark:_Toc189542093'></span>
<span style='mso-bookmark:
_Toc189542093'><span lang=HU><span style='mso-no-proof:yes'>47</span></span></span>
<span
style='mso-bookmark:_Toc189542093'><span lang=HU>. ábra Execution Policy helye
a registry-ben</span></span></p>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542093'><span lang=HU>Vagy
beállíthatjuk ezt az értéket központilag is Group Policy segítségével is. Ha
szükséges, ehhez letölthető a Microsoft </span></span><span style='mso-bookmark:
_Toc189542093'><span class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>downloads</span></span><span
lang=HU> oldaláról az „</span></span><span style='mso-bookmark:_Toc189542093'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>Administrative
templates for Windows PowerShell</span></span><span lang=HU>” adm fájl.</span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542093'><span lang=HU>Azt,
hogy milyen végrehajtási házirendek hatnak éppen a munkamenetünkre, a </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Get-ExecutionPolicy</span></span></span>
<span
style='mso-bookmark:_Toc189542093'></span>
<span
style='mso-bookmark:_Toc189542093'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlettel tudjuk lekérdezni. Méghozzá a </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>–List</span></span><span
lang=HU> kapcsolóval az összes lehetséges hely fel lesz sorolva, ahonnan
kaphatunk ilyen jellegű házirendet:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>PS C:\&gt; Get-ExecutionPolicy -List</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU><o:p>&nbsp;</o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                                 
</span>Scope<span style='mso-spacerun:yes'>                       
</span>ExecutionPolicy</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                                 
</span>-----<span style='mso-spacerun:yes'>                       
</span>---------------</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                         
</span>MachinePolicy<span
style='mso-spacerun:yes'>                              </span>Undefined</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                            
</span>UserPolicy<span style='mso-spacerun:yes'>                             
</span>Undefined</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                               
</span>Process<span style='mso-spacerun:yes'>                             
</span>Undefined</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                           
</span>CurrentUser<span style='mso-spacerun:yes'>                             
</span>Undefined</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>                          
</span>LocalMachine<span style='mso-spacerun:yes'>                          
</span>RemoteSigned</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Állítsuk
be a megfelelő biztonsági szintet a PowerShell cmdlet segítségével (legalább </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>RemoteSigned</span></span><span
lang=HU>) és próbáljuk meg ismét az indítást! (Természetesen csak rendszergazda
jogosultságok birtokában tudjuk ezt megtenni.) Az előbb talán túl sokat is
gépeltünk a fájl a c: gyökerében van, elég lesz csak ennyi:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[5] PS C:\&gt; elso.ps1</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>The term
'elso.ps1' is not recognized as the name of a cmdlet, function, scrip<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>t file, or
operable program. Check the spelling of the name, or if a path was<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>included,
verify that the path is correct and try again.<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>At line:1
char:9<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'>+ elso.ps1
&lt;&lt;&lt;&lt;<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ CategoryInfo<span
style='mso-spacerun:yes'>          </span>: ObjectNotFound: (elso.ps1:String)
[], CommandNo<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>   </span>tFoundException<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:red'><span
style='mso-spacerun:yes'>    </span>+ FullyQualifiedErrorId :
CommandNotFoundException<o:p></o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU><o:p>&nbsp;</o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU><o:p>&nbsp;</o:p></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Suggestion [3,General]: The command elso.ps1 was not found, but
does exist in t</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>he current location. Windows PowerShell doesn't load commands from
the current</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>location by default. If you trust this command, instead type
&quot;.\elso.ps1&quot;. See</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>&quot;get-help about_Command_Precedence&quot; for more details.</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Hát ez nem
elég! Régi jó UNIX / Linux szokás szerint a PowerShell nem próbálja az aktuális
mappában megtalálni a megadott futtatható állományt, így teljes útvonalat
(relatív vagy abszolút) kell megadnunk. Tehát például az alábbi módon
indíthatjuk el végre a korábban létrehozott szkriptet:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[8] PS C:\&gt; .\elso.ps1</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Hurrá! Fut az első szkriptünk.</span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542093'><span lang=HU>Ha
az aktuális mappában nem is, de a PATH környezeti változóban felsorolt
mappákban természetesen próbálkozik a PowerShell, ilyen esetben nem szükséges
útvonalat megadnunk.</span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542093'><span lang=HU>Sajnos
még mindig nem vagyunk teljesen készen, mivel ha szkriptünk útvonala szóköz
karaktert is tartalmaz, újabb problémába ütközünk. Hozzunk létre egy újabb
szkriptet a 'C:\Könyvtár szóközzel\második.ps1' mappában!</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[4] PS C:\&gt; &quot;'Hurrá! Fut a 2. szkriptem.'&quot; | Out-File
'C:\Könyvtár szóközzel\má</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>sodik.ps1'</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Rutinosabb
versenyző persze nem is próbálkozik az idézőjelek nélküli indítással, ez
azonban ebben az esetben kevés, mivel a parancs így nem parancs és nem is
útvonal, csak egy közönséges karakterlánc:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[6] PS C:\&gt; 'C:\Könyvtár szóközzel\második.ps1'</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>C:\Könyvtár szóközzel\második.ps1 </span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Be kell
vetnünk a korábban már használt „futtató” karaktert (</span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>&amp;</span></span><span
lang=HU>) az alábbi módon:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[7] PS C:\&gt; &amp; 'C:\Könyvtár szóközzel\második.ps1'</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Hurrá! Fut a 2. szkriptem.</span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-bottom:none;mso-border-top-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:1.0pt 4.0pt 0cm 4.0pt;
background:#C6D9F1;mso-background-themecolor:text2;mso-background-themetint:
51;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyzs style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto;background:#C6D9F1;
mso-background-themecolor:text2;mso-background-themetint:51'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Megjegyzés</span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-top:none;mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-bottom-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:0cm 4.0pt 1.0pt 4.0pt;
margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyezs2 style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>Ha a beviteli sor elején
kezdünk el olyan elérési utat gépelni, amelyben szóköz karakter van, akkor a
TAB billentyű lenyomására a PowerShell a könyvtár nevének kiegészítésekor
automatikusan beilleszti a sor elejére a végrehatás operátorát és az aposztrófot.</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Végül
foglaljuk össze röviden mi is szükséges ahhoz, hogy PowerShell szkripteket
futtassunk:</span></span></p>

<p class=BulletSzvegCxSpFirst style='mso-list:l7 level1 lfo5'><span
style='mso-bookmark:_Toc189542093'>
<span lang=HU>Be kell állítanunk a megfelelő
végrehajtási szabályt (</span></span><span style='mso-bookmark:_Toc189542093'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>execution
policy</span></span><span lang=HU>). Alapértelmezés szerint a PowerShell nem
futtat le semmiféle szkriptet, akárhogy is adjuk meg az útvonalat.</span></span></p>

<p class=BulletSzvegCxSpMiddle style='mso-list:l7 level1 lfo5'><span
style='mso-bookmark:_Toc189542093'>
<span lang=HU>A szkript indításához adjuk meg
annak teljes útvonalát, illetve ha a fájl az aktuális mappában van, használjuk
a </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>.\</span></span><span
lang=HU> jelölést. Útvonal nélkül is elindíthatjuk a szkriptet, ha olyan
mappában van, amely szerepel a Windows keresési útvonalán (PATH környezeti
változó).</span></span></p>

<p class=BulletSzvegCxSpLast style='mso-list:l7 level1 lfo5'><span
style='mso-bookmark:_Toc189542093'>
<span lang=HU>Ha az útvonal szóközöket
tartalmaz, tegyük idézőjelek közé és írjuk elé a futtató karaktert (</span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>&amp;</span></span><span
lang=HU>).</span></span></p>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>A korábbi
szokásokkal (cmd, vbs, stb.) ellentétben (természetesen szintén biztonsági
okokból) maga a szkriptfájl közvetlenül nem indítható el a shellen kívül, mivel
a </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>ps1</span></span><span
lang=HU> kiterjesztésű fájlokat alapértelmezés szerint a notepad.exe nyitja
meg. PowerShell 3.0 után megjelent egy új lehetőség szkriptek futtatására. Ha a
Windows fájlböngésző ablakában egy szkriptfájlra jobb egérgombbal kattintunk,
akkor megjelenik egy új menüpont: „</span></span><span style='mso-bookmark:
_Toc189542093'><span class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>Run
with PowerShell</span></span><span lang=HU>”:</span></span></p>

<p class=Kp>
 <img src="PowerShell5_files/image066.png">
</p>

<p class=MsoCaption><span style='mso-bookmark:_Toc189542093'></span>
<span style='mso-bookmark:
_Toc189542093'><span lang=HU><span style='mso-no-proof:yes'>48</span></span></span>
<span
style='mso-bookmark:_Toc189542093'><span lang=HU>. ábra Run with PowerShell
menü</span></span></p>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Ha nem a
grafikus felület segítségével, hanem például egy hagyományos logonszkriptből
szeretnénk szkriptet futtatni, akkor elsőként a powershell.exe-t kell elindítanunk
(keresési útvonalon van). Ennek paraméterként adhatjuk át futtatandó
szkriptfájl nevét. A cmd.exe-ből például az alábbi módon indíthatjuk el a fenti
szkriptet (a </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>-noexit</span></span><span
lang=HU> kapcsoló hatására a powershell.exe nem áll le a szkript lefuttatása
után, megfigyelhető, hogy a PowerShellre jellemző promptot kapunk vissza):</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>C:\&gt;powershell -noexit c:\elso.ps1</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Hurrá! Fut az első szkriptünk.</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>PS C:\&gt;</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Próbáljuk
meg hasonló módon elindítani a </span></span><span style='mso-bookmark:_Toc189542093'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>masodik.ps1</span></span><span
lang=HU> szkriptet is! Nyilván itt is kell a futtató karakter:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>C:\Users\Administrator&gt;powershell -noexit &amp;&quot;c:\Könyvtár
szóközzel\második.ps1&quot;</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Windows PowerShell</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Copyright (C) 2009 Microsoft Corporation. All rights reserved.</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU><o:p>&nbsp;</o:p></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[1] PS C:\&gt;</span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542093'><span lang=HU>Ugyan
látható a promptból, hogy a cmd shell átalakult PowerShellé, de sajnos a
szkriptünk így sem futott le. Még egy trükkre van szükség, a cmd.exe elől el
kell rejteni a PowerShellnek szóló </span></span><span style='mso-bookmark:
_Toc189542093'><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>&amp;</span></span><span lang=HU> jelet egy újabb, külső
idézőjelpárral:</span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>C:\Users\Administrator&gt;powershell -noexit &quot;&amp;
'c:\Könyvtár szóközzel\második.ps1</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>'&quot;</span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Hurrá! Fut a 2. szkriptem.</span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>[1] PS C:\&gt;</span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-bottom:none;mso-border-top-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:1.0pt 4.0pt 0cm 4.0pt;
background:#C6D9F1;mso-background-themecolor:text2;mso-background-themetint:
51;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyzs style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto;background:#C6D9F1;
mso-background-themecolor:text2;mso-background-themetint:51'><span
style='mso-bookmark:_Toc189542093'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Megjegyzés</span></span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-top:none;mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-bottom-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:0cm 4.0pt 1.0pt 4.0pt;
margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyezs2CxSpFirst style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>Itt most fontos, hogy a külső
idézőjel a macskaköröm legyen, a belső pedig az aposztróf, egyéb módokon nem
fut le helyesen. </span></span></p>

<p class=Megjegyezs2CxSpLast style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
style='mso-bookmark:_Toc189542093'><span lang=HU>Ha logonszkriptekben
szerepeltetjük ezt a parancsot, akkor ne használjuk a </span></span><span
style='mso-bookmark:_Toc189542093'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>–noexit</span></span><span
lang=HU> paramétert.</span></span></p>

</div>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
