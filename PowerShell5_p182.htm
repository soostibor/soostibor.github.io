<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>2.4.7 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><span style='mso-bookmark:_Toc189542102'><a
name="_Toc197149243"></a><a name="_Toc204716334"></a><a name="_Toc209115877"><span
style='mso-bookmark:_Toc204716334'><span style='mso-bookmark:_Toc197149243'>
<span lang=HU>Hibakeresés
háttérfolyamatokban és távoli munkamenetekben</span></span></span></a><span
style='mso-bookmark:_Toc197149243'></span></span></h3>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>PowerShell 5.0-nál korábbi
verziók esetében nem volt könnyű dolgunk háttérfolyamatként futó vagy távoli
módon futtatott szkriptek hibafelderítésében. Az általános módszer az volt,
hogy a háttérben vagy távol futó szkripteket előtérben futtattuk, és ott használtuk
a megszakítási pontokat és egyéb lehetőségeket. Ez akkor volt problematikus,
amikor pont a paraméterátadással vagy az eredmények átvételével kapcsolatban
gyanakodtunk hibákra, hiszen a normál módon futtatott szkriptekkel az így
előforduló hibalehetőségek nem voltak szimulálhatók.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>PowerShell 5.0-ban már
teljesértékű módon, akár az ISE grafikus szerkesztőben is könnyen kereshetjük a
hibákat.</span></span></span></p>

<h4 style='mso-list:l1 level4 lfo1'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><a name="_Ref139635340"></a><a
name="_Ref139635350"></a><a name="_Toc204716335"></a><a name="_Toc209115878"><span
style='mso-bookmark:_Toc204716335'><span style='mso-bookmark:_Ref139635350'><span
style='mso-bookmark:_Ref139635340'>
<span lang=HU>Hibakeresés
háttérfolyamatokban</span></span></span></span></a></span></span></h4>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Háttérfolyamatok esetében nagyon egyszerű a
dolgunk. Nézzünk egy nagyon egyszerű példát:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$script </span><span lang=HU style='color:darkgray'>=</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> {</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span>$a </span><span lang=HU
style='color:darkgray'>=</span><span lang=HU style='color:black;mso-color-alt:
windowtext'> </span><span lang=HU style='color:darkred'>&quot;valami&quot;</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span></span><span lang=HU
style='color:blue'>Wait-Debugger</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span></span><span lang=HU
style='color:blue'>Write-Host</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:darkred'>&quot;haliho&quot;</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>}</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:blue'>Start-Job</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:navy'>-ScriptBlock</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> $script </span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Látható, hogy itt megszakítási pont helyett a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Wait-Debugger</span></span><span
lang=HU> cmdlettel szakítom meg a futtatást. Ha ezt elindítom, majd lekérdezem
a futó háttérfolyamatokat, akkor ezt látom:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\PowerShell&gt; Get-Job</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>Id<span style='mso-spacerun:yes'>     </span>Name<span
style='mso-spacerun:yes'>            </span>PSJobTypeName<span
style='mso-spacerun:yes'>   </span>State<span style='mso-spacerun:yes'>        
</span>HasMoreData<span style='mso-spacerun:yes'>     </span>Location<span
style='mso-spacerun:yes'>  </span></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>--<span style='mso-spacerun:yes'>     </span>----<span
style='mso-spacerun:yes'>            </span>-------------<span
style='mso-spacerun:yes'>   </span>-----<span style='mso-spacerun:yes'>        
</span>-----------<span style='mso-spacerun:yes'>     </span>--------<span
style='mso-spacerun:yes'>  </span></span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>10<span style='mso-spacerun:yes'>     </span>Job10<span
style='mso-spacerun:yes'>           </span>BackgroundJob<span
style='mso-spacerun:yes'>   </span>AtBreakpoint<span style='mso-spacerun:yes'> 
</span>True<span style='mso-spacerun:yes'>            </span>localhost </span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Egy új státus jelent meg, az „</span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>AtBreakpoint</span></span><span
lang=HU>”, ami azt mutatja, hogy az adott háttérfolyamat a hibakeresésre vár.
Ezt indítani a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Debug-Job</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlettel tudjuk:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\PowerShell&gt; Debug-Job -Id 10</span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:aqua'>Stopped at: Write-Host &quot;haliho&quot;<o:p></o:p></span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU><span style='mso-spacerun:yes'> </span>És innentől
használhatjuk a továbblépés, folytatás és egyéb lehetőségeket. Még látványosabb
a dolog, ha a héttérfolyamat szkrtiptblokkját elmentjük fájlként, és azt
futtatjuk háttérfolyamatként: </span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:blue'>Set-Content</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:navy'>-Path</span><span lang=HU style='color:black;mso-color-alt:
windowtext'> C:\PowerShell\job.ps1 </span><span lang=HU style='color:navy'>-Value</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:orangered'>$script</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:blue'>Start-Job</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:navy'>-ScriptBlock</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> {</span><span lang=HU
style='color:blue'>C:\PowerShell\job.ps1</span><span lang=HU style='color:black;
mso-color-alt:windowtext'>}</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Itt szintén megáll a futtatás és szintén el kell
indítani a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=EnglishChar><span
style='mso-bidi-font-family:"Times New Roman"'>debugger</span></span><span
lang=HU>-t:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISE style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\PowerShell&gt; Debug-Job -Id 12</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU><span style='mso-spacerun:yes'> </span>De ilyenkor
automatikusan betöltődik az elmentett szkript az ISE-ben egy újabb fülön és
megjelenik a sárga héttérrel kiemelt sor:</span></span></span></p>

<p class=Kp>
 <img src="PowerShell5_files/image122.png">
</p>

<p class=MsoCaption><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-no-proof:yes'>100</span></span></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU>. ábra
Elmentett szkript háttérben futtatásakor teljes értékű a hibakeresés</span></span></span></p>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Azért még mindig lehetne
fokozni a hibakeresési élményt azzal, hogy az előtérben történő lépésenkénti
végrehajtásnál át tudnánk lépni a </span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Start-Job</span></span><span
lang=HU> sorából a háttérben futó szkript lépésenkénti végrehajtásába, de ez
sajnos még nem megy, muszáj </span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Wait-Debugger</span></span><span
lang=HU>-t tenni oda.</span></span></span></p>

<p class=SzvegCxSpMiddle><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Az előző fejezetben látott „</span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>BreakAll</span></span><span
lang=HU>” funkciót szintén ellátja a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Debug-Job</span></span><span
lang=HU> cmdlet. Ha a háttérfolyamatunk hosszabb ideig fut és nem raktunk be </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Wait-Debugger</span></span><span
lang=HU>-t, akkor a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Debug-Job</span></span><span
lang=HU> erőszakkal is megállítja a háttérfolyamatot és belép hibakeresési
módba.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Ez a hibakeresés akkor is
működik, ha nem is én indítottam el a PowerShell processzt. A </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Get-PSHostProcessInfo</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlet segítségével fel tudom mérni, hogy
melyek azok a processzek, amik a PowerShell-t futtatják, lehetnek ezek akár
háttérfolyamatok (job), powershell.exe vagy ISE, akármi. Most épp egy ISE a
folyamat, amit szeretnék elemezgetni:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
Get-PSHostProcessInfo</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>ProcessName<span
style='mso-spacerun:yes'>    </span>ProcessId AppDomainName<span
style='mso-spacerun:yes'>    </span>MainWindowTitle</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>-----------<span
style='mso-spacerun:yes'>    </span>--------- -------------<span
style='mso-spacerun:yes'>    </span>---------------</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>powershell<span
style='mso-spacerun:yes'>          </span>8020 DefaultAppDomain Windows
PowerShell</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>powershell_ise<span
style='mso-spacerun:yes'>     </span>19804 DefaultAppDomain Windows PowerShell
ISE</span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Ennek az ISE folyamatnak az
azonosítója 19804. Hozzá tudok csatlakozni ehhez a processzhez az </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Enter-PSHostProcess</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>segítségével:</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
Enter-PSHostProcess -Id 19804</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[Process:19804]: PS
C:\Users\Tibi\Documents&gt; Get-Runspace</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Ilyenkor a prompt is megváltozik. Ilyenkor mi nem
ugyanabba a fő </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=EnglishChar><span
style='mso-bidi-font-family:"Times New Roman"'>runspace</span></span><span
lang=HU>-be csatlakozunk be, hanem egy új nyílik számunkra. Ezeket a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>runspace</span></span><span
lang=HU>-eket felmérhetjük:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[Process:19804]: PS
C:\Users\Tibi\Documents&gt; Get-Runspace</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'> </span>Id Name<span
style='mso-spacerun:yes'>            </span>ComputerName<span
style='mso-spacerun:yes'>    </span>Type<span
style='mso-spacerun:yes'>          </span>State<span
style='mso-spacerun:yes'>         </span>Availability</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'> </span>-- ----<span
style='mso-spacerun:yes'>            </span>------------<span
style='mso-spacerun:yes'>    </span>----<span
style='mso-spacerun:yes'>          </span>-----<span
style='mso-spacerun:yes'>         </span>------------</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>  </span>1 Runspace1<span
style='mso-spacerun:yes'>       </span>localhost<span
style='mso-spacerun:yes'>       </span>Local<span
style='mso-spacerun:yes'>         </span>Opened<span
style='mso-spacerun:yes'>        </span>Busy</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>  </span>2 RemoteHost<span
style='mso-spacerun:yes'>      </span>localhost<span
style='mso-spacerun:yes'>       </span>Local<span
style='mso-spacerun:yes'>         </span>Opened<span
style='mso-spacerun:yes'>        </span>Busy</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>A </span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>RemoteHost</span></span><span
lang=HU> nevű </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=EnglishChar><span
style='mso-bidi-font-family:"Times New Roman"'>runspace</span></span> <span
lang=HU>az, ami most megnyílt számunkra, tehát abban vagyok épp most benne. Ha
szeretném az ISE-ben futó szkriptemet debugolni, akkor a 1-esbe kell belépjek a
</span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Debug-Runspace</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlettel:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[Process:19804]: PS
C:\Users\Tibi\Documents&gt; Debug-Runspace -Id 1</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>Debugging Runspace:
Runspace1</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>To end the debugging
session type the 'Detach' command at the debugger prompt,</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>or type 'Ctrl+C'
otherwise.</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>At line:1 char:7</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>+ while($true){Get-Random;
Start-Sleep 1}</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>+<span
style='mso-spacerun:yes'>       </span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Itt mutatja is, hogy hol állt éppen meg a
szkriptem, tudnék a szokásos debug parancsokkal operálni. Ha a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$PID</span></span><span
lang=HU> változót megnézem, akkor látszik, hogy tényleg az ISE processzben
vagyok benne:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[DBG]: [Process:19804]:
[Runspace1]: PS Course:\&gt;&gt; $PID</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>19804</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Ha kész vagyok a hibakereséssel, akkor a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>detach</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>paranccsal léphetek ki a debug runspace-ből,
ilyenkor folytatódik a szkript futása a háttérben, majd az </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>exit</span></span><span
lang=HU>-tel a processzből:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[DBG]: [Process:19804]:
[Runspace1]: PS Course:\&gt;&gt; detach</span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[Process:19804]: PS
C:\Users\Tibi\Documents&gt; exit</span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;</span></span></span></p>

</div>

<h4 style='mso-list:l1 level4 lfo1'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><a name="_Toc204716336"></a><a
name="_Toc209115879"><span style='mso-bookmark:_Toc204716336'>
<span lang=HU>Távoli
munkamenetek hibafelderítése</span></span></a></span></span></h4>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Csak egy kicsit bonyolultabb a helyzetünk távoli
munkamenetek hibakeresésekor. Induljunk ki hasonló helyzetből, mint az
előzőekben látott, elmentett szkript-alapú példa volt, méghozzá tervezett
hibafelderítést végzünk a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Wait-Debugger</span></span><span
lang=HU> cmdlet használatával:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$rs = {</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>$pid</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>$a = 1</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>Wait-Debugger </span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>Get-date</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>   </span>}</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Set-Content -Path $env:TEMP\remscr.ps1 -Value $rs</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$s = New-PSSession -ComputerName dc2016</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Copy-Item -ToSession $s -Path $env:TEMP\remscr.ps1 -Destination
c:\powershell</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>Invoke-Command -Session $s
-ScriptBlock {&amp; c:\powershell\remscr.ps1}</span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Itt az </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$rs</span></span><span
lang=HU> változóban tárolom a távoli futtatásra szánt szkriptet. Ennek első
sorában található a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>$pid</span></span><span lang=HU>
változó kiíratása, mert ez adja meg nekünk a távoli PowerShell processz
azonosítóját és erre szükségünk lenne abban az esetben, ha nem rendelkeznénk a
hibafelderítéshez szükséges </span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>sessionID</span></span><span
lang=HU>-val. Ilyen példánk lesz a 2., ezt tehát mindenképpen érdemes
valamilyen módon kinyerni a futtatás során.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Ezt a szkriptet elmentem az
ideiglenes mappába, majd megnyitok egy kapcsolatot a távoli géphez. A szkriptet
– kihasználva a PowerShell 5.0 új lehetőségét – ezen a távoli kapcsolaton
keresztül másolom át a DC2016 gépem </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>c:\powershell</span></span><span
lang=HU> mappájába. Végén meghívom távoli végrehajtással ezt a szkriptet.</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISE style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>3228</span></span></span></p>

<p class=WarningCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>WARNING: Session Session1 with instance ID
bbd0e04b-7286-4a0b-be2c-cdda7a3bfab5 on computer dc2016 has been disconnected
because the script running on the session has stopped at a breakpoint.</span></span></span></p>

<p class=WarningCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'> </span>Use the Enter-PSSession cmdlet
on this session to connect back to the session and begin interactive debugging.</span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Láthatjuk, hogy a
processzazonosító 3228 és hogy a távoli kapcsolat bontódott is, mert a távoli
szkript hibakereső állapotba került. A </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>session</span></span><span
lang=HU> egyedi azonosítója (</span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>instanceID</span></span><span
lang=HU>) látható is a figyelmeztető üzenetben, erre is szükségünk lehet.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Most tulajdonképpen bármelyik
gépről folytathatjuk a hibafelderítést, egyszerűség kedvéért folytassuk
ugyanazon a gépen, annál is inkább, hiszen a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>session</span></span><span
lang=HU> objektum még mindig megtalálható a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$s</span></span><span
lang=HU> változóban, így egyszerűen újra tudunk ehhez csatlakozni, majd be is
léphetünk ebbe a munkamenetbe:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\Windows\system32&gt; Connect-PSSession -Session $s</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'> </span>Id Name<span
style='mso-spacerun:yes'>            </span>ComputerName<span
style='mso-spacerun:yes'>    </span>State<span
style='mso-spacerun:yes'>         </span>ConfigurationName<span
style='mso-spacerun:yes'>     </span>Availability</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'> </span>-- ----<span
style='mso-spacerun:yes'>            </span>------------<span
style='mso-spacerun:yes'>    </span>-----<span
style='mso-spacerun:yes'>         </span>-----------------<span
style='mso-spacerun:yes'>     </span>------------</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'>  </span>1 Session1<span
style='mso-spacerun:yes'>        </span>dc2016<span
style='mso-spacerun:yes'>          </span>Opened<span
style='mso-spacerun:yes'>        </span>Microsoft.PowerShell<span
style='mso-spacerun:yes'>   </span>RemoteDebug</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\Windows\system32&gt; Enter-PSSession -Session $s</span></span></span></p>

<p class=Warning style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>WARNING: You have entered a session that is currently stopped at a
debug breakpoint inside a running command or script.<span
style='mso-spacerun:yes'>  </span>Use the Windows PowerShell command line
debugger to continue debugging.</span></span></span></p>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [DBG]: PS C:\Users\Administrator\Documents&gt;&gt;</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Ilyenkor az ISE a PowerShell 5.0-ban – miután egy
elmentett szkriptről van szó – meg is nyitja ezt egy új szkriptszerkesztő
fülön:</span></span></span></p>

<p class=Kp>
</p>

<p class=MsoCaption><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-no-proof:yes'>101</span></span></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU>. ábra A
távoli szkript automatikusan megnyílik az ISE szerkesztőjében</span></span></span></p>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Látható a fül szövegében, hogy
ez egy távoli szkript (</span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>[Remote File]</span></span><span
lang=HU>), de ettől függetlenül a hibafelderítés minden lehetősége
rendelkezésünkre áll, mint például a lépésenkénti végrehajtás, vagy a változók
tartalmának kiolvasása.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Most nézzük azt az esetet,
amikor egy hosszan futó szkriptünk van, és nem tervezett módon akarunk
hibafelderítést végezni. Ehhez a módosított szkript a következő:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$rs = {</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>$pid</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>$a = 1</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>while($true){</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>            </span>Get-date</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>            </span>Start-Sleep 5</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span>}</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>   </span>}</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Set-Content -Path $env:TEMP\remscr.ps1 -Value $rs</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$s = New-PSSession -ComputerName dc2016</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU style='color:black;mso-color-alt:
windowtext'>Copy-Item -ToSession $s -Path $env:TEMP\remscr.ps1 -Destination
c:\powershell</span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU style='color:black;mso-color-alt:windowtext'>Invoke-Command -Session $s
-ScriptBlock {&amp; c:\powershell\remscr.ps1}</span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Az első sorban a futó processz
azonosítóját, a végtelen ciklusban az aktuális időt írom ki. Itt is elmentem a
szkriptet és a távoli kapcsolaton keresztül másolom át a DC2016 nevű gépemre.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Ha ezt elindítom, meg is kapom
a processz azonosítót és az időadatok elkezdenek csordogálni:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>3176</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>2015. szeptember 19., szombat 23:50:36</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>2015. szeptember 19., szombat 23:50:41</span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>2015. szeptember 19., szombat 23:50:46</span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>Nézzük most azt a helyzetet, mintha nem férnénk
hozzá a session azonosítójához. Ez némileg igaz is, hiszen fut a szkriptünk így
most nem tudunk belenézni a </span></span></span><span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$s</span></span><span
lang=HU> tartalmába, és nem akarjuk megállítani. Nyitok egy új Powershell
Tab-ot az ISE-ben:</span></span></span></p>

<p class=Kp>
 <img src="PowerShell5_files/image124.png">
</p>

<p class=MsoCaption><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-no-proof:yes'>102</span></span></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU>. ábra
New PowerShell Tab - új PowerShell processz ugyanabban az ISE ablakban</span></span></span></p>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Toc197149243'><span lang=HU>És itt futtatom a következő cmdleteket:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\Windows\system32&gt; Enter-PSSession -ComputerName dc2016</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: PS C:\Users\Administrator\Documents&gt; Enter-PSHostProcess
-id 3176</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [Process:3176]: PS C:\Users\Administrator\Documents&gt;
Get-Runspace</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'> </span>Id Name<span
style='mso-spacerun:yes'>            </span>ComputerName<span
style='mso-spacerun:yes'>    </span>Type<span
style='mso-spacerun:yes'>          </span>State<span
style='mso-spacerun:yes'>         </span>Availability<span
style='mso-spacerun:yes'>   </span></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'> </span>-- ----<span
style='mso-spacerun:yes'>            </span>------------<span
style='mso-spacerun:yes'>    </span>----<span
style='mso-spacerun:yes'>          </span>-----<span
style='mso-spacerun:yes'>         </span>------------<span
style='mso-spacerun:yes'>   </span></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'>  </span>1 RemoteHost<span
style='mso-spacerun:yes'>      </span>localhost<span
style='mso-spacerun:yes'>       </span>Local<span
style='mso-spacerun:yes'>         </span>Opened<span
style='mso-spacerun:yes'>        </span>Busy<span
style='mso-spacerun:yes'>           </span></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><span style='mso-spacerun:yes'>  </span>2 RemoteHost<span
style='mso-spacerun:yes'>      </span>localhost<span
style='mso-spacerun:yes'>       </span>Local<span
style='mso-spacerun:yes'>         </span>Opened<span
style='mso-spacerun:yes'>        </span>Busy<span
style='mso-spacerun:yes'>           </span></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [Process:3176]: PS C:\Users\Administrator\Documents&gt;
Debug-Runspace 1</span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [DBG]: [Process:3176]: [RemoteHost]: PS
C:\Users\Administrator\Documents&gt;&gt;</span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Első lépésben tehát
csatlakoztam a DC2016 gépemhez, majd az előbb látott 3176-os processzhez
csatlakozom az új </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Enter-PSHostProcess</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlettel. Látható, hogy a sor elején, a
promptban a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>[dc2016]</span></span><span
lang=HU> mellett immár a </span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>[Process:3176]</span></span><span
lang=HU> is megjelent. Még nem értünk teljesen célt, hiszen a processz egy új
futtatási környezetébe (másik szál) érkeztünk, a hibakeresést az 1-es számú
Runspace-ben kell végezzük, így oda csatlakozom a </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Debug-Runspace</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'><span
style='mso-spacerun:yes'> </span>1</span></span><span lang=HU> cmdlettel.
Ilyenkor megint megnyílik a szkriptszerkesztőben a távoli szkript és sárga
kiemeléssel mutatja, hogy éppen melyik sornál állítottuk meg a futtatást.</span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span lang=HU>Ha végeztem a
hibafelderítéssel és szeretném, hogy a szkript futása folytatódjon, akkor az új
</span></span></span><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Toc197149243'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>detach</span></span></span></span>
<span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'></span></span>
<span style='mso-bookmark:
_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span lang=HU><span
style='mso-spacerun:yes'> </span>paranccsal bezárhatom ezt az üzemmódot, majd </span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>exit</span></span><span
lang=HU>-el kiléphetek a távoli kapcsolatból:</span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISECxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [DBG]: [Process:2480]: [RemoteHost]: PS
C:\Users\Administrator&gt;&gt; detach</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>[dc2016]: [Process:2480]: PS C:\Users\Administrator\Documents&gt; exit</span></span></span></p>

<p class=ISECxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></p>

<p class=ISECxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Toc197149243'><span
lang=HU>PS C:\Windows\system32&gt;</span></span></span></p>

</div>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
