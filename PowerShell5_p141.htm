<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>1.11.6 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><a
name="_Ref524872168"></a><a name="_Toc204716275"></a><a name="_Toc209115818"><span
style='mso-bookmark:_Toc204716275'><span style='mso-bookmark:_Ref524872168'>
<span lang=HU>Függvény
átadása háttérfolyamatoknak és távoli munkameneteknek</span></span></span></a></span></span></span></h3>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU>Gyakran előfordul, hogy van egy jópofa segédfüggvényünk, amit
szeretnénk egy háttérfolyamatban vagy távoli munkamanet során is használni.
Miután ezek külön processzben futnak ezért a fő processzünk függvénye nem
látszik a távoli vagy háttérben futó szkriptünk számára, így azt át kell adni.</span></span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU>Legyen a segédfüggvényem a következő:</span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:darkblue'>function</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> MyFunction {</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span><span lang=HU style='color:darkblue'>Param</span><span
lang=HU style='color:black;mso-color-alt:windowtext'>(</span><span lang=HU
style='color:darkgray'>[</span><span lang=HU style='color:teal'>string</span><span
lang=HU style='color:darkgray'>]</span><span lang=HU style='color:orangered'>$somestring</span><span
lang=HU style='color:black;mso-color-alt:windowtext'>)</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span><span lang=HU style='color:darkred'>&quot;|
</span><span lang=HU style='color:orangered'>$somestring</span><span lang=HU
style='color:darkred'> |&quot;</span></span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:black;mso-color-alt:
windowtext'>}</span></span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:
_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span lang=HU>Ez ugye
egyszerűen a paraméterként adott sztringet két függőleges vonal között
visszaadja. A háttérben futó szkriptem legyen ez:</span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'>$jobscript </span><span
lang=HU style='color:darkgray'>=</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> {</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span><span lang=HU style='color:darkblue'>param</span><span
lang=HU style='color:black;mso-color-alt:windowtext'>(</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>         </span></span><span lang=HU style='color:
darkgray'>[</span><span lang=HU style='color:teal'>PSObject</span><span
lang=HU style='color:darkgray'>[]]</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:orangered'>$functions</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>)</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU><o:p>&nbsp;</o:p></span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span><span lang=HU style='color:darkblue'>foreach</span><span
lang=HU style='color:black;mso-color-alt:windowtext'>($f </span><span lang=HU
style='color:darkblue'>in</span><span lang=HU style='color:black;mso-color-alt:
windowtext'> $functions){</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>        </span></span><span lang=HU style='color:darkgray'>[</span><span
lang=HU style='color:teal'>void</span><span lang=HU style='color:darkgray'>]</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> (</span><span lang=HU
style='color:blue'>new-item</span><span lang=HU style='color:black;mso-color-alt:
windowtext'> </span><span lang=HU style='color:navy'>-Path</span><span lang=HU
style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:blueviolet'>function:</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:navy'>-Name</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> $f</span><span lang=HU
style='color:darkgray'>.</span><span lang=HU style='color:black;mso-color-alt:
windowtext'>name </span><span lang=HU style='color:navy'>-Value</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> $f</span><span lang=HU
style='color:darkgray'>.</span><span lang=HU style='color:black;mso-color-alt:
windowtext'>definition)</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>}</span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span></span></span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span></span><span lang=HU style='color:blue'>MyFunction</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:navy'>-somestring</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> $env:COMPUTERNAME</span></span></span></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:black;mso-color-alt:
windowtext'>} </span></span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU>Látható, hogy ez paraméterként vár egy vagy több függvénydefiníciót
tartalmazó objektumot. Ezek valójában </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>FunctionInfo</span></span><span
lang=HU> típusú objektumok lennének, amit a </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Get-Command</span></span><span
lang=HU> paranccsal tudunk előállítani, viszont a paraméterátadás során lezajló
deszerializálás következtében (XML szöveggé alakítja a két processz között
átadott objektumokat) sajnos ezekből az objektumokból </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>[Deserialized.System.Management.Automation.FunctionInfo]</span></span><span
lang=HU> lesz, amit nem tudunk típusként felvenni, így marad a </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>[PSObject[]]</span></span><span
lang=HU>. Végigszalad ezeken a függvénydefiniciós objektumokon (itt most csak
egyet adunk át neki) és a </span></span></span></span><span style='mso-bookmark:
_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:
_Toc197149224'><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>New-Item</span></span><span lang=HU>-mel legenerálja a saját
környezetében a függvényeket. Majd itt a </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>MyFunction</span></span><span
lang=HU> hívással meg is hívja azt, itt konkrétan a gép nevét fogja keretbe
foglalni.</span></span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU>Nézzük, hogyan hozzuk létre ezek után a háttérfolyamatot:</span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#DBE5F1;
mso-shading:windowtext;mso-pattern:solid #DBE5F1;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=ISE style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#DBE5F1;mso-shading:windowtext;mso-pattern:solid #DBE5F1'><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:blue'>start-job</span><span
lang=HU> -ScriptBlock </span></span></span></span><span style='mso-bookmark:
_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:
_Toc197149224'><span lang=HU style='color:orangered'>$jobscript</span><span
lang=HU> -ArgumentList (</span></span></span></span><span style='mso-bookmark:
_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:
_Toc197149224'><span lang=HU style='color:blue'>Get-Command</span><span
lang=HU> -Name </span></span></span></span><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
lang=HU style='color:blueviolet'>MyFunction</span><span lang=HU> -CommandType </span></span></span></span><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:blueviolet'>Function</span><span
lang=HU>) </span></span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:
_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span lang=HU>Látható,
hogy az </span></span></span></span><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>ArgumentList</span></span><span
lang=HU>-nek a </span></span></span></span><span style='mso-bookmark:_Toc197149396'><span
style='mso-bookmark:_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>MyFunction</span></span><span
lang=HU> definícióját adom át. Nézzük a futtatás eredményét:</span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:black;mso-color-alt:
windowtext'>PS C:\Users\Tibi&gt; Receive-Job -id 19</span></span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:_Toc197149335'><span
style='mso-bookmark:_Toc197149224'><span lang=HU style='color:black;mso-color-alt:
windowtext'>| STLENO |</span></span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc197149396'><span style='mso-bookmark:
_Toc197149335'><span style='mso-bookmark:_Toc197149224'><span lang=HU>Ugyanígy
működik az egész távoli hívásokra is.</span></span></span></span></p>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
