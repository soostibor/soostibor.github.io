<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>1.5.5 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><a name="_Ref196147646"></a><a
name="_Ref196147656"></a><a name="_Toc197149186"></a><a name="_Toc204716181"></a><a
name="_Toc209115724"><span style='mso-bookmark:_Toc204716181'><span
style='mso-bookmark:_Toc197149186'><span style='mso-bookmark:_Ref196147656'><span
style='mso-bookmark:_Ref196147646'>
<span lang=HU>ForEach-Object
cmdlet</span></span></span></span></span></a></h3>

<p class=Szveg><span lang=HU>Az előzőekben bemutatott </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>FOREACH</span></span><span
lang=HU> egy PowerShell kulcsszó ciklus létrehozására. Azonban létezik egy
másik </span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>FOREACH</span></span><span lang=HU> is, ami a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Foreach-Object</span></span><span
lang=HU> cmdlet álneve:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[25] PS C:\&gt; get-alias
foreach</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>CommandType<span
style='mso-spacerun:yes'>     </span>Name<span
style='mso-spacerun:yes'>                            </span>Definition</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>-----------<span
style='mso-spacerun:yes'>     </span>----<span
style='mso-spacerun:yes'>                            </span>----------</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>Alias<span
style='mso-spacerun:yes'>           </span>foreach<span
style='mso-spacerun:yes'>                         </span>ForEach-Object</span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU>Honnan tudja a PowerShell hogy egy
parancssorban most melyiket is akarom használni: a kulcsszót vagy a cmdletet?
Nagyon egyszerűen: ha a </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>foreach</span></span><span
lang=HU> után egy zárójel „</span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>(</span></span><span lang=HU>”
van, akkor kulcsszóval van dolga, ha „</span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>{</span></span><span
lang=HU>” bajusz, akkor alias. Másrészt, a kulcsszavak mindig a kifejezések
elején kell, hogy álljanak. A kifejezések eleje vagy a parancssor eleje, vagy pontosvessző
(</span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>;</span></span><span lang=HU>), vagy nyitó zárójel „(”. A
csőjel (</span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>|</span></span><span lang=HU>) nem számít kifejezés
elejének.</span></p>

<p class=SzvegCxSpLast><span lang=HU>Mire lehet használni ezt a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>foreach-object</span></span><span
lang=HU> cmdletet? Míg a </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>foreach</span></span><span
lang=HU> kulcsszó tömbjének, amin végigmegy, készen kell állnia teljes
egészében, mire a vezérlés ráadódik, addig a </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>ForEach-Object</span></span><span
lang=HU> cmdlet csővezetékből érkező elemeket dolgoz fel, azaz ha már egy bemeneti
elem elkészült, akkor azt már át is veszi és elvégzi a kijelölt műveletet:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[1] PS C:\&gt; 1,2,3 |
ForEach-Object {$_ * 3}</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>3</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>6</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>9</span></p>

</div>

<p class=Szveg><span lang=HU>A fenti példában nem a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$foreach</span></span><span
lang=HU> változón keresztül értem el az aktuális elemet, hanem a szokásos </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$_</span></span><span
lang=HU> változón. </span></p>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-bottom:none;mso-border-top-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:1.0pt 4.0pt 0cm 4.0pt;
background:#C6D9F1;mso-background-themecolor:text2;mso-background-themetint:
51;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyzs style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto;background:#C6D9F1;
mso-background-themecolor:text2;mso-background-themetint:51'><span lang=HU
style='color:black;mso-color-alt:windowtext'>Megjegyzés:</span></p>

</div>

<div style='mso-element:para-border-div;border-top:none;border-left:double windowtext 5.25pt;
border-bottom:none;border-right:double windowtext 5.25pt;mso-border-left-alt:
thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:thin-thick-large-gap windowtext 5.25pt;
padding:0cm 4.0pt 0cm 4.0pt;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megj-nyitott style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span lang=HU>Van
egy érdekessége ennek a cmdletnek. Figyeljük meg a help-ben a szintaxisát:</span></p>

</div>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[2] PS C:\&gt; get-help
foreach-object</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>NAME</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>ForEach-Object</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>SYNOPSIS</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>Performs an operation against each item in
a collection of input objects.</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>SYNTAX</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>ForEach-Object [-Process]
&lt;ScriptBlock[]&gt; [-Begin &lt;ScriptBlock&gt;] [-End &lt;Sc</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>riptBlock&gt;] [-InputObject
&lt;PSObject&gt;] [-RemainingScripts &lt;ScriptBlock[]&gt;]</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>[-Confirm] [-WhatIf]
[&lt;CommonParameters&gt;]</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>ForEach-Object [-MemberName] &lt;String&gt;
[-ArgumentList &lt;Object[]&gt;] [-InputOb</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>ject &lt;PSObject&gt;] [-Confirm] [-WhatIf]
[&lt;CommonParameters&gt;]</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>...</span></p>

</div>

<div style='mso-element:para-border-div;border-top:none;border-left:double windowtext 5.25pt;
border-bottom:none;border-right:double windowtext 5.25pt;mso-border-left-alt:
thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:thin-thick-large-gap windowtext 5.25pt;
padding:0cm 4.0pt 0cm 4.0pt;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megj-nyitottCxSpFirst style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
lang=HU>Hoppá! Nem is egy, hanem három szkriptblokkot lehet átadni neki
paraméterként, kicsit hasonlóan, mint ahogy a </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>FOR</span></span><span
lang=HU> ciklusnál is három rész vezérli a ciklust. Itt a három rész szerepe: mit
tegyen az első elem érkezése előtt, mit tegyen az éppen aktuális elemek
érkezésekor, mit tegyen az utolsó elem érkezése után. </span></p>

<p class=Megj-nyitottCxSpLast style='margin-top:0.0pt;margin-right:0cm;
margin-bottom:0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span
lang=HU>Nézzünk erre egy példát:</span></p>

</div>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[13] PS C:\&gt;
&quot;egy&quot;,&quot;kettő&quot;,&quot;három&quot; | foreach-object
{&quot;----eleje----&quot;} {$_} {&quot;----vége----&quot;}</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>----eleje----</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>egy</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>kettő</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>három</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>----vége----</span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-top:none;mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-bottom-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:0cm 4.0pt 1.0pt 4.0pt;
margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyezs2 style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span lang=HU>Ebben
a példában nem is írtam ki a paraméterek neveit, azaz a pozíció alapján
rendelte hozzá az egyes szkriptblokkokat a PowerShell. Ha csak egy
szkriptblokkot adunk meg az a </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Process</span></span><span
lang=HU> szekcióhoz sorolódik.</span></p>

</div>

<p class=Szveg><span lang=HU>A fenti megjegyzésben (PowerShell 3.0-tól
kezdődően) látható, hogy egy második szintaxisa is van a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>ForEach-Object</span></span><span
lang=HU>-nek. Ezzel a gyakoribb, egyszerűbb kifejezéseket tömörebben lehet
összerakni. Például:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
&quot;egy&quot;, &quot;kettő&quot; | ForEach-Object -MemberName length</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>3</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>5</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
&quot;egy&quot;, &quot;kettő&quot; | ForEach-Object -MemberName contains
-ArgumentList g</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>True</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>False</span></p>

</div>

<p class=Szveg><span lang=HU>Ez első példa hagyományosan így nézne ki:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=Kd style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
&quot;egy&quot;, &quot;kettő&quot; | ForEach-Object {$_.length}</span></p>

</div>

<p class=Szveg><span lang=HU>A második meg így:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=Kd style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
&quot;egy&quot;, &quot;kettő&quot; | ForEach-Object
{$_.contains(&quot;g&quot;)}</span></p>

</div>

<p class=Szveg><span lang=HU>Azaz akár tulajdonságokat, akár metódusokat
egyszerűen el tudunk érni. </span></p>

<h4 style='mso-list:l1 level4 lfo1'><a name="_Ref36935217"></a><a
name="_Toc204716182"></a><a name="_Toc209115725"><span style='mso-bookmark:
_Toc204716182'><span style='mso-bookmark:_Ref36935217'>
<span lang=HU>Párhuzamos
Foreach-Object</span></span></span></a></h4>

<p class=Szveg><span lang=HU>PowerShell 7.0-ban megjelent a párhuzamos
feldolgozást lehetővé tevő </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Foreach&#8209;Object &#8209;Parallel</span></span>

<span lang=HU>:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; get-date;
10..1|ForEach-Object -Parallel {Start-Sleep $_; Write-Host $_}; Get-Date</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>2020. április 3. 22:32:47</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>6</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>7</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>8</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>9</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>10</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>2</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>3</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>1</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>4</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>5</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>2020. április 3. 22:32:58</span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU>A fenti példában két időkiíratás között
10-től 1-ig visszafelé nyomom be a számokat a csőbe, és a szám értékének
megfelelő másodpercig várakozom, majd kiírom a számot. Az eredményből látszik,
hogy nem a 10 hullott ki legelőször, hanem a 6-os. Ez azt jelenti, hogy a 10,
9,8,7,6 párhuzamosan hajtódott végre, azaz 5 szálon futott alaphelyzetben. Ezek
közül a 6 a legkisebb, úgyhogy az hullott ki először. Azt a szálat rögtön
elfoglalta az 5. A következő kihulló elem a 7-es, annak a helyére a 4 lép be,
stb. Mivel a második etap mindegyike 11 másodperc múlva hullik ki, így a
második 5 elem szinte egyszerre jelenik meg, sorrendjük nem igazán számítható
ki, a fenti példában is kicsit össze-vissza estek ki. Összefoglalva, az összesen
45 másodperc helyett 12 másodpercre volt szükség a végrehajtásra (nem 11, mert
van egy kis overhead).</span></p>

<p class=SzvegCxSpLast><span lang=HU>A párhuzamos szálak száma szabályozható a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>-ThrottleLimit</span></span><span
lang=HU> paraméterrel:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
10..1|ForEach-Object -Parallel {Start-Sleep $_; Write-Host $_} -ThrottleLimit 4</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>7</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>8</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>9</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>10</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>3</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>6</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>4</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>5</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>1</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>2</span></p>

</div>

<p class=Szveg><span lang=HU>Itt látszik, hogy 4 szál futott együtt. Lehet
megadni a időlimitet is a </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>-TimeoutSeconds</span></span><span
lang=HU> paraméterrel:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=HibaKdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
10..1|ForEach-Object -Parallel {Start-Sleep $_; Write-Host $_} -ThrottleLimit 4
-TimeoutSeconds 14</span><span lang=HU style='color:windowtext;mso-color-alt:
windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>7</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>8</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>9</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>10</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>3</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>6</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>5</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>4</span><span lang=HU
style='color:windowtext;mso-color-alt:windowtext'><o:p></o:p></span></p>

<p class=HibaKdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU>InvalidOperation: The pipeline has been stopped.</span></p>

<p class=HibaKdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU>InvalidOperation: The pipeline has been stopped.</span></p>

</div>

<p class=Szveg><span lang=HU>Látszik, hogy a timeout a szál teljes
életciklusára vonatkozik, azaz 14 másodperc esetében a 7,8,9,10 másodperc
várakozás még belefért, az utána jövő 3-6 szintén, de az 1-2 az már nem. Ugyan
7+3+2 az csak 12, de mint mondtam van egy kis „felkészülési időre” szüksége.
Azaz csak akkor érdemes ilyen paralel futtatást használni, ha legalább 10-15
másodpercig tart a feladat, illetve nem érdemes több szálat indítani, mint
ahány processzor mag van a számítógépben.</span></p>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-bottom:none;mso-border-top-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:1.0pt 4.0pt 0cm 4.0pt;
background:#C6D9F1;mso-background-themecolor:text2;mso-background-themetint:
51;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyzs style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto;background:#C6D9F1;
mso-background-themecolor:text2;mso-background-themetint:51'><span lang=HU
style='color:black;mso-color-alt:windowtext'>Megjegyzés</span></p>

</div>

<div style='mso-element:para-border-div;border-top:none;border-left:double windowtext 5.25pt;
border-bottom:none;border-right:double windowtext 5.25pt;mso-border-left-alt:
thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:thin-thick-large-gap windowtext 5.25pt;
padding:0cm 4.0pt 0cm 4.0pt;margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megj-nyitott style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span lang=HU>Ebben
a párhuzamos </span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>Foreach-Object</span></span><span lang=HU>-ben a
szkriptblokk nem ugyanúgy működik, mint a hagyományos változatban. Itt egy
külön scope-ban van a szkriptblokk, nem lát rá a külső környezet változóira:</span></p>

</div>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $a =
&quot;Kakukk&quot;</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; 1..2 |
ForEach-Object -Parallel {Write-Host &quot;$_ : $a&quot;}</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>2 :</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>1 :</span></p>

</div>

<div style='mso-element:para-border-div;border:double windowtext 5.25pt;
border-top:none;mso-border-left-alt:thin-thick-large-gap windowtext 5.25pt;
mso-border-bottom-alt:thin-thick-large-gap windowtext 5.25pt;mso-border-right-alt:
thin-thick-large-gap windowtext 5.25pt;padding:0cm 4.0pt 1.0pt 4.0pt;
margin-left:14.2pt;margin-right:14.2pt'>

<p class=Megjegyezs2 style='margin-top:0.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;mso-add-space:auto'><span lang=HU>Látszik,
hogy a szkriptblokknak nincs tudomása a kívül létrehozott </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>$a</span></span><span
lang=HU> változóról.</span></p>

</div>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
