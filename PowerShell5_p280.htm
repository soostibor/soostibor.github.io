<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>2.21.6 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><a name="_Toc204716451"></a><a
name="_Toc209115994"><span style='mso-bookmark:_Toc204716451'>
<span lang=HU>Csoportok
kezelése</span></span></a></span></span></span></span></span></span></span></span></h3>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>Az Active Directory-ban
csoportokat leginkább a rendszer üzemeltetésének megkönnyítésére veszünk fel.
Segítségükkel osztunk ki hozzáférési jogokat, felhasználói jogokat, de még a
csoportos házirendek érvényre jutását is szabályozhatjuk csoportokkal. Miután
ilyen széleskörű a felhasználásuk, így fontos lehet a csoportok kezelésének
automatizálása. Erre is kiválóan alkalmas a PowerShell, nézzük meg a
leggyakoribb műveleteket.</span></span></span></span></span></span></span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>Csoportot létrehozni a már
látott módszerrel lehet:</span></span></span></span></span></span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $target =
[ADSI] &quot;LDAP://ou=Demó,DC=iqjb,DC=w08&quot;</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $group =
$target.create(&quot;group&quot;,&quot;CN=Csoport&quot;)</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
$group.setinfo()</span></span></span></span></span></span></span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>Ez alaphelyzetben globális
biztonsági csoportot hoz létre. A későbbi, összetett példában majd bemutatom,
hogy hogyan lehet másfajta csoportokat létrehozni.</span></span></span></span></span></span></span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>Ezután kétféleképpen lehet
tagokat adni a csoportokhoz. Az első módszer a hagyományos „ADSI”-s módszer,
ahol a csoport </span></span></span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Add</span></span><span
lang=HU> metódusát hívom meg, paramétereként a berakni kívánt felhasználó
LDAP-os szintaxisú elérési útját kell megadni. Vagy, ha már megragadtam a
felhasználói fiókot, akkor vissza kell alakítani az LDAP-os elérési úttá, mint
ahogy ebben a példában tettem:</span></span></span></span></span></span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $user = [ADSI]
&quot;LDAP://CN=János Vegetári,OU=Demó,DC=iqjb,DC=w08&quot;</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
$group.add(&quot;LDAP://$($user.distinguishedname)&quot;)</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
$group.setinfo()</span></span></span></span></span></span></span></span></span></p>

</div>

<p class=SzvegCxSpFirst><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>Hasonlóan lehet tagot
eltávolítani, csak az </span></span></span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Add</span></span><span
lang=HU> helyett a </span></span></span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Remove</span></span><span
lang=HU> metódust kell meghívni.</span></span></span></span></span></span></span></span></span></p>

<p class=SzvegCxSpLast><span style='mso-bookmark:_Toc189542102'><span
style='mso-bookmark:_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span
style='mso-bookmark:_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span
style='mso-bookmark:_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span
style='mso-bookmark:_Ref255415638'><span lang=HU>A második módszer kicsit
PowerShell-szerűbb, itt nem kell ide-oda alakítgatni, elég a felhasználó </span></span></span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>distinguishedname</span></span><span
lang=HU> tulajdonságát használni:</span></span></span></span></span></span></span></span></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $user = [ADSI]
&quot;LDAP://CN=Csilla Fájdalom,OU=Demó,DC=iqjb,DC=w08&quot;</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; $group.member
+= $user.distinguishedname</span></span></span></span></span></span></span></span></span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt;
$group.setinfo()</span></span></span></span></span></span></span></span></span></p>

</div>

<p class=Szveg><span style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:
_Ref246910890'><span style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:
_Toc197149407'><span style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:
_Toc197149272'><span style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:
_Ref255415638'><span lang=HU>Természetesen a két megoldás egyenértékű, csak
stílusbeli különbség van közöttük. A második módszer hátránya talán, hogy
egyszerűen nem lehet csoporttagot eltávolítani, külön képezni kellene a
nemkívánatos tag nélküli tömböt, és azt betölteni a csoport </span></span></span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc189542102'><span style='mso-bookmark:_Ref246910890'><span
style='mso-bookmark:_Ref246910886'><span style='mso-bookmark:_Toc197149407'><span
style='mso-bookmark:_Toc197149346'><span style='mso-bookmark:_Toc197149272'><span
style='mso-bookmark:_Ref255415641'><span style='mso-bookmark:_Ref255415638'><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>member</span></span><span
lang=HU> tulajdonságába.</span></span></span></span></span></span></span></span></span></p>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
