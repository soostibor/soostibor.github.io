<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>2.30.2 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><a name="_Toc204716504"></a><a
name="_Toc209116047"><span style='mso-bookmark:_Toc204716504'>
<span lang=HU>További
példák</span></span></a></h3>

<p class=Szveg><span lang=HU>Nézzünk néhány további példát a </span><span
class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>PInvoke</span></span><span
lang=HU> lehetőségekre. Az első ezek között a </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>LockWorkstation</span></span><span
lang=HU> funkciót megvalósító függvény:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:purple'>$code</span><span
lang=HU style='color:black'> </span><span lang=HU style='color:red'>=</span><span
lang=HU style='color:black'> '[DllImport(&quot;user32.dll&quot;, SetLastError =
true)]</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'>public static extern bool LockWorkStation();'<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><b><span lang=HU style='color:cadetblue'>Add-Type</span></b><span
lang=HU style='color:black'> </span><i><span lang=HU style='color:cadetblue'>-memberDefinition</span></i><span
lang=HU style='color:black'> </span><span lang=HU style='color:purple'>$code</span><span
lang=HU style='color:black'> </span><i><span lang=HU style='color:cadetblue'>-name</span></i><span
lang=HU style='color:black'> NativeMethod </span><i><span lang=HU
style='color:cadetblue'>-namespace</span></i><span lang=HU style='color:black'>
Win32<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:blue'>function</span><span
lang=HU style='color:black'> </span><span lang=HU style='color:cadetblue'>Lock-Workstation</span><span
lang=HU style='color:black'> {<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><span
style='mso-tab-count:1'>     </span>[</span><span lang=HU style='color:teal'>Win32.NativeMethod</span><span
lang=HU style='color:black'>]::</span><span lang=HU style='color:saddlebrown'>LockWorkstation</span><span
lang=HU style='color:black'>()<o:p></o:p></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span lang=HU style='color:black'>}</span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU>Ebben nem sok nehézség van, megint csak a
</span><span class=EnglishChar><span style='mso-bidi-font-family:"Times New Roman"'>user32.dll</span></span><span
lang=HU> egyik szolgáltatását tudjuk igénybe venni immáron PowerShell
segítségével is.</span></p>

<p class=SzvegCxSpLast><span lang=HU>A következő függvény már egy kicsit
összetettebb, hiszen itt paramétereket is át kell adni a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>SystemParametersInfo</span></span><span
lang=HU> hívásakor a háttérképet beállító függvényünkben:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'>$code </span><span lang=HU style='color:red'>=</span><span lang=HU
style='color:black'> </span><span lang=HU style='color:maroon'>@'<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'>[DllImport(&quot;user32.dll&quot;)]<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'>public static
extern uint SystemParametersInfo(<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'><span
style='mso-spacerun:yes'>    </span>uint uiAction,<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'><span
style='mso-spacerun:yes'>    </span>uint uiParam,<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'><span
style='mso-spacerun:yes'>    </span>string pvParam,<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'><span
style='mso-spacerun:yes'>    </span>uint fWinIni);<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:maroon'>'@</span><span
lang=HU style='color:black'><o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><b><span lang=HU style='color:cadetblue'>Add-Type</span></b><span
lang=HU style='color:black'> </span><i><span lang=HU style='color:cadetblue'>-MemberDefinition</span></i><span
lang=HU style='color:black'> $code </span><i><span lang=HU style='color:cadetblue'>-Name</span></i><span
lang=HU style='color:black'> </span><span lang=HU style='color:maroon'>NativeMethod2</span><span
lang=HU style='color:black'> </span><i><span lang=HU style='color:cadetblue'>-Namespace</span></i><span
lang=HU style='color:black'> </span><span lang=HU style='color:maroon'>Win32</span><span
lang=HU style='color:black'><o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:blue'>function</span><span
lang=HU style='color:black'> </span><span lang=HU style='color:cadetblue'>Set-WallPaper</span><span
lang=HU style='color:black'> {<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:blue'>param</span><span
lang=HU style='color:black'>($picturepath)<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black'><span
style='mso-tab-count:1'>     </span>[win32.NativeMethod2]::SystemParametersInfo(20,
0, $picturepath, 3)<o:p></o:p></span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span lang=HU style='color:black'>}<o:p></o:p></span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU>Ez a </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>SystemParametersInfo</span></span><span
lang=HU> egyébként nagyon sok mindent tud, érdemes szétnézni a
dokumentációjában, hiszen rengeteg hasznos rendszerbeállítást végezhetünk el
segítségével.</span></p>

<p class=SzvegCxSpLast><span lang=HU>A következő függvénnyel megkapjuk, hogy a
gépünk érintés-vezérelt-e vagy sem:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 3.0pt;
mso-border-alt:wave windowtext 3.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51;margin-left:8.5pt;margin-right:8.5pt'>

<p class=KikopizhatCxSpFirst style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:darkblue'>function</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> IsTouchCapable {<span
style='mso-spacerun:yes'>    </span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span></span><span lang=HU
style='color:darkblue'>try</span><span lang=HU style='color:black;mso-color-alt:
windowtext'>{</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span></span><span lang=HU
style='color:darkgray'>[</span><span lang=HU style='color:teal'>void</span><span
lang=HU style='color:darkgray'>]</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:darkgray'>[</span><span
lang=HU style='color:teal'>user32.method</span><span lang=HU style='color:darkgray'>]</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span>}</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span></span><span lang=HU
style='color:darkblue'>catch</span><span lang=HU style='color:black;mso-color-alt:
windowtext'>{<span style='mso-spacerun:yes'>    </span></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span></span><span lang=HU
style='color:orangered'>$code</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:darkgray'>=</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:darkred'>'[DllImport(&quot;user32.dll&quot;)]<o:p></o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:darkred'><span
style='mso-spacerun:yes'>        </span>public static extern int
GetSystemMetrics(uint smIndex);'</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>        </span></span><span lang=HU
style='color:blue'>Add-Type</span><span lang=HU style='color:black;mso-color-alt:
windowtext'> </span><span lang=HU style='color:navy'>-MemberDefinition</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> </span><span lang=HU
style='color:orangered'>$code</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> </span><span lang=HU style='color:navy'>-Name</span><span
lang=HU style='color:black;mso-color-alt:windowtext'> Method </span><span
lang=HU style='color:navy'>-Namespace</span><span lang=HU style='color:black;
mso-color-alt:windowtext'> User32</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span>}</span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KikopizhatCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;
mso-add-space:auto;background:#FDE9D9;mso-background-themecolor:accent6;
mso-background-themetint:51'><span lang=HU style='color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>    </span></span><span lang=HU
style='color:darkgray'>!![</span><span lang=HU style='color:teal'>User32.Method</span><span
lang=HU style='color:darkgray'>]::</span><span lang=HU style='color:black;
mso-color-alt:windowtext'>GetSystemMetrics(</span><span lang=HU
style='color:purple'>95</span><span lang=HU style='color:black;mso-color-alt:
windowtext'>)</span></p>

<p class=KikopizhatCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#FDE9D9;mso-background-themecolor:accent6;mso-background-themetint:
51'><span lang=HU style='color:black;mso-color-alt:windowtext'>}</span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU><span
style='mso-spacerun:yes'> </span>Itt A </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>GetSystemMetrics</span></span><span
lang=HU> hívást használtam, ami szintén sok mindenre jó. Ebben a függvényben
azt a módszert követtem, hogy belül végeztem el az </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Add-Type</span></span><span
lang=HU>-al a típusdefiníciót, mégpedig úgy, hogy előbb ránézek egy </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>try</span></span><span
lang=HU> blokkban, hogy van-e már ilyen és ha nincs, akkor a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>catch</span></span><span
lang=HU>-ben végrehajtom a típusdefiníciót.</span></p>

<p class=SzvegCxSpLast><span lang=HU><o:p>&nbsp;</o:p></span></p>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
