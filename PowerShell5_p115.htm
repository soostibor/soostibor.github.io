<html xmlns:v="urn:schemas-microsoft-com:vml xml:lang="hu" lang="hu""
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-2">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="PowerShell5_files/filelist.xml">
<link rel=Edit-Time-Data href="PowerShell5_files/editdata.mso">
<link rel=OLE-Object-Data href="PowerShell5_files/oledata.mso">


<title>1.8.16 </title>


<link rel=dataStoreItem href="PowerShell5_files/item0001.xml"
target="PowerShell5_files/props002.xml">
<link rel=themeData href="PowerShell5_files/themedata.thmx">
<link rel=colorSchemeMapping href="PowerShell5_files/colorschememapping.xml">




<link rel="StyleSheet" href="PowerShell5.css">





</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:35.4pt;word-wrap:
break-word'>

<h3 style='mso-list:l1 level3 lfo1'><span style='mso-bookmark:_Toc197149222'><span
style='mso-bookmark:_Toc179036946'><a name="_Toc204716244"></a><a
name="_Toc209115787"><span style='mso-bookmark:_Toc204716244'>
<span lang=HU>Átalakítás
szöveggé (Out-String)</span></span></a></span></span></h3>

<p class=SzvegCxSpFirst><span lang=HU>Láthattuk, hogy jó dolog az
objektumorientált megközelítés, az esetek döntő többségében jelentősen
egyszerűbbé vált tőle az élet a hagyományos shellekkel összehasonlítva.
Bizonyos esetekben mégis szükség lehet arra, hogy az objektumokból álló
kimenetet szövegként dolgozzuk fel, és például egy szöveges keresés alapján
válogassuk ki belőle azokat a sorokat, amelyekre szükségünk van. Nem szerencsés
például az objektumos kimenet, ha az, amit keresünk, több tulajdonság értékében
is előfordulhat, és nekünk azok a sorok kellenek, amelyekben akárhol is, de
előfordul (vagy éppen hiányzik) a keresett érték.</span></p>

<p class=SzvegCxSpLast><span lang=HU>Listázzuk ki egy </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Get-Process</span></span><span
lang=HU> alapértelmezett kimenetéből azokat a sorokat, amelyekben (bármelyik
oszlopban!) előfordul a „44” karakterlánc! Az objektumok szöveges változatának
előállítására az </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>Out-String</span></span>

<span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlet képes. Bemenetére tetszőleges
objektumokat küldhetünk (például formázott táblázatot, listát, stb. is), a
kimenetén egy hosszú karakterlánc fog megjelenni, amely mindazt tartalmazza,
amit a bemenet a képernyőre írt volna. Próbáljuk ki a következőt:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; get-process |
out-string</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>Handles<span
style='mso-spacerun:yes'>  </span>NPM(K)<span style='mso-spacerun:yes'>   
</span>PM(K)<span style='mso-spacerun:yes'>      </span>WS(K) VM(M)<span
style='mso-spacerun:yes'>   </span>CPU(s)<span style='mso-spacerun:yes'>    
</span>Id ProcessName</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>-------<span
style='mso-spacerun:yes'>  </span>------<span style='mso-spacerun:yes'>   
</span>-----<span style='mso-spacerun:yes'>      </span>----- -----<span
style='mso-spacerun:yes'>   </span>------<span style='mso-spacerun:yes'>    
</span>-- -----------</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>     </span>66<span style='mso-spacerun:yes'>      
</span>3<span style='mso-spacerun:yes'>      </span>864<span
style='mso-spacerun:yes'>       </span>2808<span style='mso-spacerun:yes'>   
</span>30<span style='mso-spacerun:yes'>     </span>0,08<span
style='mso-spacerun:yes'>    </span>416 ctfmon</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>173<span style='mso-spacerun:yes'>      
</span>5<span style='mso-spacerun:yes'>     </span>3564<span
style='mso-spacerun:yes'>       </span>5340<span style='mso-spacerun:yes'>   
</span>33<span style='mso-spacerun:yes'>     </span>0,19<span
style='mso-spacerun:yes'>   </span>1100 CTHELPER</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>     </span>29<span style='mso-spacerun:yes'>      
</span>1<span style='mso-spacerun:yes'>      </span>380<span
style='mso-spacerun:yes'>        </span>756<span style='mso-spacerun:yes'>   
</span>15<span style='mso-spacerun:yes'>     </span>0,02<span
style='mso-spacerun:yes'>   </span>1436 CTSVCCDA</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>473<span style='mso-spacerun:yes'>      
</span>6<span style='mso-spacerun:yes'>     </span>2144<span
style='mso-spacerun:yes'>       </span>2420<span style='mso-spacerun:yes'>   
</span>28<span style='mso-spacerun:yes'>    </span>11,45<span
style='mso-spacerun:yes'>    </span>612 csrss</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>689<span style='mso-spacerun:yes'>     
</span>18<span style='mso-spacerun:yes'>    </span>25440<span
style='mso-spacerun:yes'>      </span>18048<span style='mso-spacerun:yes'>  
</span>107<span style='mso-spacerun:yes'>    </span>50,84<span
style='mso-spacerun:yes'>   </span>3804 explorer</span></p>

</div>

<p class=SzvegCxSpFirst><span lang=HU>Látszólag semmi különbség nincs az önálló
</span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Get-Process</span></span><span
lang=HU>-hez képest, de ha a kimenetre kérünk egy </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Get-Member</span></span><span
lang=HU>-t, akkor látható, hogy az már nem </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>System.Diagnostics.Process</span></span><span
lang=HU> objektumokból áll, hanem egyszerű karakterlánccá alakult.</span></p>

<p class=SzvegCxSpLast><span lang=HU>Már csak a szöveges keresés van hátra,
amelyet a </span><span class=KdInlineChar><span lang=HU style='mso-bidi-font-family:
"Times New Roman"'>Select-String</span></span>

<span lang=HU><span
style='mso-spacerun:yes'> </span>cmdlet segítségével fogunk elvégezni (ezzel
részletesen a </span>
<span
lang=HU><i style='mso-bidi-font-style:normal'>2.6.7</i>
</span>
<span lang=HU><i
style='mso-bidi-font-style:normal'> </i></span>
<span
lang=HU><i style='mso-bidi-font-style:normal'>Szövegfájlok beolvasása
(Get-Content)</i>
</span>
<span lang=HU>
fejezetben lesz szó):</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=Kd style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; get-process |
out-string | select-string -pattern &quot;44&quot;</span></p>

</div>

<p class=Szveg><span lang=HU>Valami még nem egészen kerek, mivel ismét csak a
teljes listát kaptuk vissza. Mi lehet a baj? Az </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>Out-String</span></span><span
lang=HU> cmdlet alapértelmezés szerint <b style='mso-bidi-font-weight:normal'>egyetlen</b>
karakterláncot ad vissza, ami a teljes listát tartalmazza a sortörésektől
függetlenül. A teljes listában persze ott van a keresett minta, így az egyetlen
karakterlánc közül azt az egyet kiírtuk a képernyőre. Soronként tördelt
kimenetet (karakterláncokból álló tömböt) a </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>-stream</span></span><span
lang=HU> paraméter használatával kérhetünk, a helyes megoldás tehát:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>PS C:\&gt; get-process |
out-string -stream | select-string -pattern &quot;44&quot;</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU><o:p>&nbsp;</o:p></span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>     </span>37<span style='mso-spacerun:yes'>      
</span>2<span style='mso-spacerun:yes'>     </span>2016<span
style='mso-spacerun:yes'>         </span>40<span style='mso-spacerun:yes'>   
</span>30<span style='mso-spacerun:yes'>     </span>0,09<span
style='mso-spacerun:yes'>   </span>3144 cmd</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>     </span>63<span style='mso-spacerun:yes'>      
</span>3<span style='mso-spacerun:yes'>     </span>1068<span
style='mso-spacerun:yes'>        </span>372<span style='mso-spacerun:yes'>   
</span>30<span style='mso-spacerun:yes'>     </span>0,09<span
style='mso-spacerun:yes'>    </span>844 daemon</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>779<span style='mso-spacerun:yes'>     
</span>20<span style='mso-spacerun:yes'>    </span>67944<span
style='mso-spacerun:yes'>       </span>7200<span style='mso-spacerun:yes'>  
</span>198<span style='mso-spacerun:yes'>    </span>19,30<span
style='mso-spacerun:yes'>   </span>2496 iexplore</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>     </span>21<span style='mso-spacerun:yes'>      
</span>1<span style='mso-spacerun:yes'>      </span>168<span
style='mso-spacerun:yes'>        </span>144<span style='mso-spacerun:yes'>    
</span>4<span style='mso-spacerun:yes'>     </span>0,08<span
style='mso-spacerun:yes'>    </span>920 smss</span></p>

<p class=KdCxSpMiddle style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>162<span style='mso-spacerun:yes'>      
</span>7<span style='mso-spacerun:yes'>     </span>4960<span
style='mso-spacerun:yes'>       </span>2652<span style='mso-spacerun:yes'>   
</span>60<span style='mso-spacerun:yes'>     </span>0,44<span
style='mso-spacerun:yes'>   </span>1968 spoolsv</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'><span
style='mso-spacerun:yes'>    </span>142<span style='mso-spacerun:yes'>      
</span>4<span style='mso-spacerun:yes'>     </span>2396<span
style='mso-spacerun:yes'>        </span>372<span style='mso-spacerun:yes'>   
</span>44<span style='mso-spacerun:yes'>     </span>0,50<span
style='mso-spacerun:yes'>    </span>640 VsTskMgr</span></p>

</div>

<p class=Szveg><span lang=HU>Az </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>out-string</span></span><span
lang=HU>-nek van még egy praktikus paramétere, ez pedig a </span><span
class=KdInlineChar><span lang=HU style='mso-bidi-font-family:"Times New Roman"'>–width</span></span><span
lang=HU>. Ez akkor jöhet jól, ha nagyon széles táblázatot akarunk
megjeleníteni, és az alaphelyzet szerinti 80 karakteres szélesség túl kevésnek
tűnik. Mi van akkor, ha a </span><span class=KdInlineChar><span lang=HU
style='mso-bidi-font-family:"Times New Roman"'>get-process</span></span><span
lang=HU>-szel a folyamatok összes tulajdonságát meg akarom jeleníteni. Ez 80
karakterben gyakorlatilag reménytelen, nézzük meg, hogy 600 karakterbe hogyan
fér el:</span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;mso-border-shadow:yes;background:#F2F2F2;
mso-shading:windowtext;mso-pattern:gray-5 auto;margin-left:8.5pt;margin-right:
8.5pt'>

<p class=KdCxSpFirst style='margin:0cm;margin-bottom:.0001pt;mso-add-space:
auto;background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>[19] PS C:\&gt;get-process
| ft -Property * | out-string -Width 600 -Stream &gt; c</span></p>

<p class=KdCxSpLast style='margin:0cm;margin-bottom:.0001pt;mso-add-space:auto;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'><span
lang=HU style='color:black;mso-color-alt:windowtext'>:\old\proc.txt</span></p>

</div>

<p class=Szveg><span lang=HU>Ezek után nézzük Notepad-del a fájlt:</span></p>

<p class=Kp>
 <img src="PowerShell5_files/image077.png">
</p>

<p class=MsoCaption>
<span lang=HU><span
style='mso-no-proof:yes'>59</span></span>
<span
lang=HU>. ábra 600 karakter széles szöveg Notepadben</span></p>

<p class=Szveg><span lang=HU>A sortörést kikapcsoltam, és látszik, hogy
viszonylag jól elférünk már. Az alsó gördítő sáv méretéből látható, hogy elég
jócskán lehet vízszintesen görgetni ezt a táblázatot. Ezzel gyakorlatilag
ugyanazt az eredményt értem el, mint az </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>out-file</span></span><span
lang=HU> cmdlet használatával, megfelelő </span><span class=KdInlineChar><span
lang=HU style='mso-bidi-font-family:"Times New Roman"'>–width</span></span><span
lang=HU> paraméterrel.</span></p>

<P><P><BR><BR><P class=MsoNormal style="text-align:center;font-size:10"><a href="http://www.technoriversoft.com/wordtohtmlconversion.html">Word To HTML Converter</a>

</body>

</html>
